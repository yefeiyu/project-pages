---
date: 2018-04-10
tags: 
- soft
- docker
- debian
- jekyll
- blog
author: yefeiyu
layout: post
title: Use docker for jekyll blog, which is the 在github中搭建用org-mode和org2jekyll发布及用lunr.js中文搜索的jekyll静态独立博客 II
subtitle: 使用docker集成jekyll的环境，一次配置，多处使用
categories: 
- soft
---
<p>
For a long time ago, I writed the blog [<a href="https://yefeiyu.github.io/soft/2016/05/02/%E5%9C%A8github%E4%B8%AD%E6%90%AD%E5%BB%BA%E7%94%A8org-mode%E5%92%8Corg2jekyll%E5%8F%91%E5%B8%83%E5%8F%8A%E7%94%A8lunr.js%E4%B8%AD%E6%96%87%E6%90%9C%E7%B4%A2%E7%9A%84jekyll%E9%9D%99%E6%80%81%E7%8B%AC%E7%AB%8B%E5%8D%9A%E5%AE%A2.html">本教程第I篇</a>](《在github中搭建用org-mode和org2jekyll发布及用lunr.js中文搜索的jekyll静态独立博客》), now there is a new method of build entire environment of jekyll-blog. Use the Docker CE, only 3 steps to complete the complex methods writen in the previous blog post.
Let's start.
Install the new stretch OS of Debian 9, If we to configurate the blog environment of Ruby, Node, NPM, Grunt&#x2026;, it will waste too many times. So We use Docker.
</p>
<div id="outline-container-org7113829" class="outline-2">
<h2 id="org7113829">Install docker CE through Docker's official tutorial. The address is</h2>
<div class="outline-text-2" id="text-org7113829">
<p>
[<a href="https://docs.docker.com/install/linux/docker-ce/debian/#install-using-the-repository">docker 教程</a>](Get Docker CE for Debian)
</p>
<div class="org-src-container">
<pre class="src src-c">sudo apt-get install      apt-transport-https      ca-certificates      curl      gnupg2      software-properties-common
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
sudo apt-key fingerprint 0EBFCD88
sudo add-apt-repository    "deb [arch=amd64] https://download.docker.com/linux/debian \
   $(lsb_release -cs) \
   stable"
sudo apt-get update
sudo apt-get install docker-ce
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb607c97" class="outline-2">
<h2 id="orgb607c97">Pull my docker repository</h2>
<div class="outline-text-2" id="text-orgb607c97">
<div class="org-src-container">
<pre class="src src-c">s docker pull xxmm/ruby-node-grunt:v1
</pre>
</div>
<p>
xxmm/ruby-node-grunt:v1 FROM starefossen/ruby-node, the Dockerfile is:
</p>
<div class="org-src-container">
<pre class="src src-ruby">FROM starefossen/ruby-node

RUN apt-get update &amp;&amp; \
    apt-get -y install apt-utils sudo &amp;&amp; \
    useradd -d /home/xx -m -s /bin/bash xx &amp;&amp; \
    echo xx:xx | chpasswd &amp;&amp; \
    adduser xx sudo &amp;&amp; \
    npm install -g bower grunt-cli
USER xx
RUN mkdir /home/xx/.ssh/ &amp;&amp; \
    mkdir /home/xx/mt/ &amp;&amp; \
    mkdir -p /home/xx/gh/yefeiyu.github.io/
COPY .bash_aliases /home/xx/
COPY Gemfile /home/xx/gh/yefeiyu.github.io/
COPY package.json /home/xx/gh/yefeiyu.github.io/
WORKDIR /home/xx/gh/yefeiyu.github.io/
RUN bundle install &amp;&amp; \
    rm *
</pre>
</div>
<p>
As we seen, which add the user of xx, and created the environment needed for the blog. The steps is created 3 folders, copy 3 documents which build environment needed and bundle install. 
</p>
</div>
</div>
<div id="outline-container-org127ae41" class="outline-2">
<h2 id="org127ae41">Use docker for jekyll blog</h2>
<div class="outline-text-2" id="text-org127ae41">
<div class="org-src-container">
<pre class="src src-c">docker run -ti --rm -u 0 -p 4321:4321 -p 35729:35729 -v /home/xx/gh/yefeiyu.github.io/:/home/xx/gh/yefeiyu.github.io/ -v /home/xx/.ssh/:/home/xx/.ssh/ xxmm/ruby-node-grunt:v1 grunt serve
</pre>
</div>

<p>
It's so simple! 
If we want to use docker under Windows 10, which need to OPEN the hyper-V in windows system settings of applications.
</p>
</div>
</div>
<div id="outline-container-org78258cf" class="outline-2">
<h2 id="org78258cf">Because I mount github.io folder by -v, I need git clone the git repository first, and write the blog at local.</h2>
<div class="outline-text-2" id="text-org78258cf">
<p>
The local need the node<sub>modules</sub> folder.
</p>
</div>
</div>
